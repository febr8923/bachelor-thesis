Python from: /users/fbrunne/projects/deps/python311/bin/python3
/users/fbrunne/projects/deps/patch-venv/lib/python3.11/site-packages/torch/__init__.py
/users/fbrunne/projects/deps/patch-venv/lib/python3.11/site-packages/transformers/utils/hub.py:124: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(
/users/fbrunne/projects/deps/patch-venv/lib/python3.11/site-packages/huggingface_hub/file_download.py:942: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
A new version of the following files was downloaded from https://huggingface.co/Qwen/Qwen-7B:
- tokenization_qwen.py
. Make sure to double-check they do not contain any added malicious code. To avoid downloading new versions of the code file, you can pin a revision.
A new version of the following files was downloaded from https://huggingface.co/Qwen/Qwen-7B:
- configuration_qwen.py
. Make sure to double-check they do not contain any added malicious code. To avoid downloading new versions of the code file, you can pin a revision.
A new version of the following files was downloaded from https://huggingface.co/Qwen/Qwen-7B:
- modeling_qwen.py
. Make sure to double-check they do not contain any added malicious code. To avoid downloading new versions of the code file, you can pin a revision.
Your device support faster inference by passing bf16=True in "AutoModelForCausalLM.from_pretrained".
Loading model Qwen/Qwen-7B...
Loading checkpoint shards:   0%|          | 0/8 [00:00<?, ?it/s]Loading checkpoint shards:  12%|█▎        | 1/8 [00:02<00:16,  2.36s/it]Loading checkpoint shards:  25%|██▌       | 2/8 [00:04<00:13,  2.23s/it]Loading checkpoint shards:  38%|███▊      | 3/8 [00:06<00:10,  2.20s/it]Loading checkpoint shards:  50%|█████     | 4/8 [00:09<00:09,  2.30s/it]Loading checkpoint shards:  62%|██████▎   | 5/8 [00:10<00:06,  2.14s/it]Loading checkpoint shards:  75%|███████▌  | 6/8 [00:13<00:04,  2.22s/it]Loading checkpoint shards:  88%|████████▊ | 7/8 [00:14<00:02,  2.03s/it]Loading checkpoint shards: 100%|██████████| 8/8 [00:16<00:00,  1.89s/it]Loading checkpoint shards: 100%|██████████| 8/8 [00:16<00:00,  2.07s/it]
/users/fbrunne/projects/deps/patch-venv/lib/python3.11/site-packages/huggingface_hub/file_download.py:942: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/users/fbrunne/projects/deps/patch-venv/lib/python3.11/site-packages/transformers/generation/configuration_utils.py:497: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.8` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
/users/fbrunne/projects/deps/patch-venv/lib/python3.11/site-packages/transformers/generation/configuration_utils.py:509: UserWarning: `do_sample` is set to `False`. However, `top_k` is set to `0` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_k`.
  warnings.warn(
Model loaded successfully
model_loc: gpu, exec_loc: gpu
transformer.wte.weight cuda:0
transformer.h.0.ln_1.weight cuda:0
transformer.h.0.attn.c_attn.weight cuda:0
transformer.h.0.attn.c_attn.bias cuda:0
transformer.h.0.attn.c_proj.weight cuda:0
transformer.h.0.ln_2.weight cuda:0
transformer.h.0.mlp.w1.weight cuda:0
transformer.h.0.mlp.w2.weight cuda:0
transformer.h.0.mlp.c_proj.weight cuda:0
transformer.h.1.ln_1.weight cuda:0
transformer.h.1.attn.c_attn.weight cuda:0
transformer.h.1.attn.c_attn.bias cuda:0
transformer.h.1.attn.c_proj.weight cuda:0
transformer.h.1.ln_2.weight cuda:0
transformer.h.1.mlp.w1.weight cuda:0
transformer.h.1.mlp.w2.weight cuda:0
transformer.h.1.mlp.c_proj.weight cuda:0
transformer.h.2.ln_1.weight cuda:0
transformer.h.2.attn.c_attn.weight cuda:0
transformer.h.2.attn.c_attn.bias cuda:0
transformer.h.2.attn.c_proj.weight cuda:0
transformer.h.2.ln_2.weight cuda:0
transformer.h.2.mlp.w1.weight cuda:0
transformer.h.2.mlp.w2.weight cuda:0
transformer.h.2.mlp.c_proj.weight cuda:0
transformer.h.3.ln_1.weight cuda:0
transformer.h.3.attn.c_attn.weight cuda:0
transformer.h.3.attn.c_attn.bias cuda:0
transformer.h.3.attn.c_proj.weight cuda:0
transformer.h.3.ln_2.weight cuda:0
transformer.h.3.mlp.w1.weight cuda:0
transformer.h.3.mlp.w2.weight cuda:0
transformer.h.3.mlp.c_proj.weight cuda:0
transformer.h.4.ln_1.weight cuda:0
transformer.h.4.attn.c_attn.weight cuda:0
transformer.h.4.attn.c_attn.bias cuda:0
transformer.h.4.attn.c_proj.weight cuda:0
transformer.h.4.ln_2.weight cuda:0
transformer.h.4.mlp.w1.weight cuda:0
transformer.h.4.mlp.w2.weight cuda:0
transformer.h.4.mlp.c_proj.weight cuda:0
transformer.h.5.ln_1.weight cuda:0
transformer.h.5.attn.c_attn.weight cuda:0
transformer.h.5.attn.c_attn.bias cuda:0
transformer.h.5.attn.c_proj.weight cuda:0
transformer.h.5.ln_2.weight cuda:0
transformer.h.5.mlp.w1.weight cuda:0
transformer.h.5.mlp.w2.weight cuda:0
transformer.h.5.mlp.c_proj.weight cuda:0
transformer.h.6.ln_1.weight cuda:0
transformer.h.6.attn.c_attn.weight cuda:0
transformer.h.6.attn.c_attn.bias cuda:0
transformer.h.6.attn.c_proj.weight cuda:0
transformer.h.6.ln_2.weight cuda:0
transformer.h.6.mlp.w1.weight cuda:0
transformer.h.6.mlp.w2.weight cuda:0
transformer.h.6.mlp.c_proj.weight cuda:0
transformer.h.7.ln_1.weight cuda:0
transformer.h.7.attn.c_attn.weight cuda:0
transformer.h.7.attn.c_attn.bias cuda:0
transformer.h.7.attn.c_proj.weight cuda:0
transformer.h.7.ln_2.weight cuda:0
transformer.h.7.mlp.w1.weight cuda:0
transformer.h.7.mlp.w2.weight cuda:0
transformer.h.7.mlp.c_proj.weight cuda:0
transformer.h.8.ln_1.weight cuda:0
transformer.h.8.attn.c_attn.weight cuda:0
transformer.h.8.attn.c_attn.bias cuda:0
transformer.h.8.attn.c_proj.weight cuda:0
transformer.h.8.ln_2.weight cuda:0
transformer.h.8.mlp.w1.weight cuda:0
transformer.h.8.mlp.w2.weight cuda:0
transformer.h.8.mlp.c_proj.weight cuda:0
transformer.h.9.ln_1.weight cuda:0
transformer.h.9.attn.c_attn.weight cuda:0
transformer.h.9.attn.c_attn.bias cuda:0
transformer.h.9.attn.c_proj.weight cuda:0
transformer.h.9.ln_2.weight cuda:0
transformer.h.9.mlp.w1.weight cuda:0
transformer.h.9.mlp.w2.weight cuda:0
transformer.h.9.mlp.c_proj.weight cuda:0
transformer.h.10.ln_1.weight cuda:0
transformer.h.10.attn.c_attn.weight cuda:0
transformer.h.10.attn.c_attn.bias cuda:0
transformer.h.10.attn.c_proj.weight cuda:0
transformer.h.10.ln_2.weight cuda:0
transformer.h.10.mlp.w1.weight cuda:0
transformer.h.10.mlp.w2.weight cuda:0
transformer.h.10.mlp.c_proj.weight cuda:0
transformer.h.11.ln_1.weight cuda:0
transformer.h.11.attn.c_attn.weight cuda:0
transformer.h.11.attn.c_attn.bias cuda:0
transformer.h.11.attn.c_proj.weight cuda:0
transformer.h.11.ln_2.weight cuda:0
transformer.h.11.mlp.w1.weight cuda:0
transformer.h.11.mlp.w2.weight cuda:0
transformer.h.11.mlp.c_proj.weight cuda:0
transformer.h.12.ln_1.weight cuda:0
transformer.h.12.attn.c_attn.weight cuda:0
transformer.h.12.attn.c_attn.bias cuda:0
transformer.h.12.attn.c_proj.weight cuda:0
transformer.h.12.ln_2.weight cuda:0
transformer.h.12.mlp.w1.weight cuda:0
transformer.h.12.mlp.w2.weight cuda:0
transformer.h.12.mlp.c_proj.weight cuda:0
transformer.h.13.ln_1.weight cuda:0
transformer.h.13.attn.c_attn.weight cuda:0
transformer.h.13.attn.c_attn.bias cuda:0
transformer.h.13.attn.c_proj.weight cuda:0
transformer.h.13.ln_2.weight cuda:0
transformer.h.13.mlp.w1.weight cuda:0
transformer.h.13.mlp.w2.weight cuda:0
transformer.h.13.mlp.c_proj.weight cuda:0
transformer.h.14.ln_1.weight cuda:0
transformer.h.14.attn.c_attn.weight cuda:0
transformer.h.14.attn.c_attn.bias cuda:0
transformer.h.14.attn.c_proj.weight cuda:0
transformer.h.14.ln_2.weight cuda:0
transformer.h.14.mlp.w1.weight cuda:0
transformer.h.14.mlp.w2.weight cuda:0
transformer.h.14.mlp.c_proj.weight cuda:0
transformer.h.15.ln_1.weight cuda:0
transformer.h.15.attn.c_attn.weight cuda:0
transformer.h.15.attn.c_attn.bias cuda:0
transformer.h.15.attn.c_proj.weight cuda:0
transformer.h.15.ln_2.weight cuda:0
transformer.h.15.mlp.w1.weight cuda:0
transformer.h.15.mlp.w2.weight cuda:0
transformer.h.15.mlp.c_proj.weight cuda:0
transformer.h.16.ln_1.weight cuda:0
transformer.h.16.attn.c_attn.weight cuda:0
transformer.h.16.attn.c_attn.bias cuda:0
transformer.h.16.attn.c_proj.weight cuda:0
transformer.h.16.ln_2.weight cuda:0
transformer.h.16.mlp.w1.weight cuda:0
transformer.h.16.mlp.w2.weight cuda:0
transformer.h.16.mlp.c_proj.weight cuda:0
transformer.h.17.ln_1.weight cuda:0
transformer.h.17.attn.c_attn.weight cuda:0
transformer.h.17.attn.c_attn.bias cuda:0
transformer.h.17.attn.c_proj.weight cuda:0
transformer.h.17.ln_2.weight cuda:0
transformer.h.17.mlp.w1.weight cuda:0
transformer.h.17.mlp.w2.weight cuda:0
transformer.h.17.mlp.c_proj.weight cuda:0
transformer.h.18.ln_1.weight cuda:0
transformer.h.18.attn.c_attn.weight cuda:0
transformer.h.18.attn.c_attn.bias cuda:0
transformer.h.18.attn.c_proj.weight cuda:0
transformer.h.18.ln_2.weight cuda:0
transformer.h.18.mlp.w1.weight cuda:0
transformer.h.18.mlp.w2.weight cuda:0
transformer.h.18.mlp.c_proj.weight cuda:0
transformer.h.19.ln_1.weight cuda:0
transformer.h.19.attn.c_attn.weight cuda:0
transformer.h.19.attn.c_attn.bias cuda:0
transformer.h.19.attn.c_proj.weight cuda:0
transformer.h.19.ln_2.weight cuda:0
transformer.h.19.mlp.w1.weight cuda:0
transformer.h.19.mlp.w2.weight cuda:0
transformer.h.19.mlp.c_proj.weight cuda:0
transformer.h.20.ln_1.weight cuda:0
transformer.h.20.attn.c_attn.weight cuda:0
transformer.h.20.attn.c_attn.bias cuda:0
transformer.h.20.attn.c_proj.weight cuda:0
transformer.h.20.ln_2.weight cuda:0
transformer.h.20.mlp.w1.weight cuda:0
transformer.h.20.mlp.w2.weight cuda:0
transformer.h.20.mlp.c_proj.weight cuda:0
transformer.h.21.ln_1.weight cuda:0
transformer.h.21.attn.c_attn.weight cuda:0
transformer.h.21.attn.c_attn.bias cuda:0
transformer.h.21.attn.c_proj.weight cuda:0
transformer.h.21.ln_2.weight cuda:0
transformer.h.21.mlp.w1.weight cuda:0
transformer.h.21.mlp.w2.weight cuda:0
transformer.h.21.mlp.c_proj.weight cuda:0
transformer.h.22.ln_1.weight cuda:0
transformer.h.22.attn.c_attn.weight cuda:0
transformer.h.22.attn.c_attn.bias cuda:0
transformer.h.22.attn.c_proj.weight cuda:0
transformer.h.22.ln_2.weight cuda:0
transformer.h.22.mlp.w1.weight cuda:0
transformer.h.22.mlp.w2.weight cuda:0
transformer.h.22.mlp.c_proj.weight cuda:0
transformer.h.23.ln_1.weight cuda:0
transformer.h.23.attn.c_attn.weight cuda:0
transformer.h.23.attn.c_attn.bias cuda:0
transformer.h.23.attn.c_proj.weight cuda:0
transformer.h.23.ln_2.weight cuda:0
transformer.h.23.mlp.w1.weight cuda:0
transformer.h.23.mlp.w2.weight cuda:0
transformer.h.23.mlp.c_proj.weight cuda:0
transformer.h.24.ln_1.weight cuda:0
transformer.h.24.attn.c_attn.weight cuda:0
transformer.h.24.attn.c_attn.bias cuda:0
transformer.h.24.attn.c_proj.weight cuda:0
transformer.h.24.ln_2.weight cuda:0
transformer.h.24.mlp.w1.weight cuda:0
transformer.h.24.mlp.w2.weight cuda:0
transformer.h.24.mlp.c_proj.weight cuda:0
transformer.h.25.ln_1.weight cuda:0
transformer.h.25.attn.c_attn.weight cuda:0
transformer.h.25.attn.c_attn.bias cuda:0
transformer.h.25.attn.c_proj.weight cuda:0
transformer.h.25.ln_2.weight cuda:0
transformer.h.25.mlp.w1.weight cuda:0
Traceback (most recent call last):
  File "/users/fbrunne/projects/benchmarks/run-patch.py", line 141, in <module>
transformer.h.25.mlp.w2.weight cuda:0
transformer.h.25.mlp.c_proj.weight cuda:0
transformer.h.26.ln_1.weight cuda:0
transformer.h.26.attn.c_attn.weight cuda:0
transformer.h.26.attn.c_attn.bias cuda:0
transformer.h.26.attn.c_proj.weight cuda:0
transformer.h.26.ln_2.weight cuda:0
transformer.h.26.mlp.w1.weight cuda:0
transformer.h.26.mlp.w2.weight cuda:0
transformer.h.26.mlp.c_proj.weight cuda:0
transformer.h.27.ln_1.weight cuda:0
transformer.h.27.attn.c_attn.weight cuda:0
transformer.h.27.attn.c_attn.bias cuda:0
transformer.h.27.attn.c_proj.weight cuda:0
transformer.h.27.ln_2.weight cuda:0
transformer.h.27.mlp.w1.weight cuda:0
transformer.h.27.mlp.w2.weight cuda:0
transformer.h.27.mlp.c_proj.weight cuda:0
transformer.h.28.ln_1.weight cuda:0
transformer.h.28.attn.c_attn.weight cuda:0
transformer.h.28.attn.c_attn.bias cuda:0
transformer.h.28.attn.c_proj.weight cuda:0
transformer.h.28.ln_2.weight cuda:0
transformer.h.28.mlp.w1.weight cuda:0
transformer.h.28.mlp.w2.weight cuda:0
transformer.h.28.mlp.c_proj.weight cuda:0
transformer.h.29.ln_1.weight cuda:0
transformer.h.29.attn.c_attn.weight cuda:0
transformer.h.29.attn.c_attn.bias cuda:0
transformer.h.29.attn.c_proj.weight cuda:0
transformer.h.29.ln_2.weight cuda:0
transformer.h.29.mlp.w1.weight cuda:0
transformer.h.29.mlp.w2.weight cuda:0
transformer.h.29.mlp.c_proj.weight cuda:0
transformer.h.30.ln_1.weight cuda:0
transformer.h.30.attn.c_attn.weight cuda:0
transformer.h.30.attn.c_attn.bias cuda:0
transformer.h.30.attn.c_proj.weight cuda:0
transformer.h.30.ln_2.weight cuda:0
transformer.h.30.mlp.w1.weight cuda:0
transformer.h.30.mlp.w2.weight cuda:0
transformer.h.30.mlp.c_proj.weight cuda:0
transformer.h.31.ln_1.weight cuda:0
transformer.h.31.attn.c_attn.weight cuda:0
transformer.h.31.attn.c_attn.bias cuda:0
transformer.h.31.attn.c_proj.weight cuda:0
transformer.h.31.ln_2.weight cuda:0
transformer.h.31.mlp.w1.weight cuda:0
transformer.h.31.mlp.w2.weight cuda:0
transformer.h.31.mlp.c_proj.weight cuda:0
transformer.ln_f.weight cuda:0
lm_head.weight cuda:0
transformer.rotary_emb.inv_freq cuda:0
transformer.h.0.attn.masked_bias cuda:0
transformer.h.0.attn.logn_tensor cuda:0
transformer.h.1.attn.masked_bias cuda:0
transformer.h.1.attn.logn_tensor cuda:0
transformer.h.2.attn.masked_bias cuda:0
transformer.h.2.attn.logn_tensor cuda:0
transformer.h.3.attn.masked_bias cuda:0
transformer.h.3.attn.logn_tensor cuda:0
transformer.h.4.attn.masked_bias cuda:0
transformer.h.4.attn.logn_tensor cuda:0
transformer.h.5.attn.masked_bias cuda:0
transformer.h.5.attn.logn_tensor cuda:0
transformer.h.6.attn.masked_bias cuda:0
transformer.h.6.attn.logn_tensor cuda:0
transformer.h.7.attn.masked_bias cuda:0
transformer.h.7.attn.logn_tensor cuda:0
transformer.h.8.attn.masked_bias cuda:0
transformer.h.8.attn.logn_tensor cuda:0
transformer.h.9.attn.masked_bias cuda:0
transformer.h.9.attn.logn_tensor cuda:0
transformer.h.10.attn.masked_bias cuda:0
transformer.h.10.attn.logn_tensor cuda:0
transformer.h.11.attn.masked_bias cuda:0
transformer.h.11.attn.logn_tensor cuda:0
transformer.h.12.attn.masked_bias cuda:0
transformer.h.12.attn.logn_tensor cuda:0
transformer.h.13.attn.masked_bias cuda:0
transformer.h.13.attn.logn_tensor cuda:0
transformer.h.14.attn.masked_bias cuda:0
transformer.h.14.attn.logn_tensor cuda:0
transformer.h.15.attn.masked_bias cuda:0
transformer.h.15.attn.logn_tensor cuda:0
transformer.h.16.attn.masked_bias cuda:0
transformer.h.16.attn.logn_tensor cuda:0
transformer.h.17.attn.masked_bias cuda:0
transformer.h.17.attn.logn_tensor cuda:0
transformer.h.18.attn.masked_bias cuda:0
transformer.h.18.attn.logn_tensor cuda:0
transformer.h.19.attn.masked_bias cuda:0
transformer.h.19.attn.logn_tensor cuda:0
transformer.h.20.attn.masked_bias cuda:0
transformer.h.20.attn.logn_tensor cuda:0
transformer.h.21.attn.masked_bias cuda:0
transformer.h.21.attn.logn_tensor cuda:0
transformer.h.22.attn.masked_bias cuda:0
transformer.h.22.attn.logn_tensor cuda:0
transformer.h.23.attn.masked_bias cuda:0
transformer.h.23.attn.logn_tensor cuda:0
transformer.h.24.attn.masked_bias cuda:0
transformer.h.24.attn.logn_tensor cuda:0
transformer.h.25.attn.masked_bias cuda:0
transformer.h.25.attn.logn_tensor cuda:0
transformer.h.26.attn.masked_bias cuda:0
transformer.h.26.attn.logn_tensor cuda:0
transformer.h.27.attn.masked_bias cuda:0
transformer.h.27.attn.logn_tensor cuda:0
transformer.h.28.attn.masked_bias cuda:0
transformer.h.28.attn.logn_tensor cuda:0
transformer.h.29.attn.masked_bias cuda:0
transformer.h.29.attn.logn_tensor cuda:0
transformer.h.30.attn.masked_bias cuda:0
transformer.h.30.attn.logn_tensor cuda:0
transformer.h.31.attn.masked_bias cuda:0
transformer.h.31.attn.logn_tensor cuda:0
--------
model_loc: gpu, exec_loc: gpu
transformer.wte.weight cuda:0
transformer.h.0.ln_1.weight cuda:0
transformer.h.0.attn.c_attn.weight cuda:0
transformer.h.0.attn.c_attn.bias cuda:0
transformer.h.0.attn.c_proj.weight cuda:0
transformer.h.0.ln_2.weight cuda:0
transformer.h.0.mlp.w1.weight cuda:0
transformer.h.0.mlp.w2.weight cuda:0
transformer.h.0.mlp.c_proj.weight cuda:0
transformer.h.1.ln_1.weight cuda:0
transformer.h.1.attn.c_attn.weight cuda:0
transformer.h.1.attn.c_attn.bias cuda:0
transformer.h.1.attn.c_proj.weight cuda:0
transformer.h.1.ln_2.weight cuda:0
transformer.h.1.mlp.w1.weight cuda:0
transformer.h.1.mlp.w2.weight cuda:0
transformer.h.1.mlp.c_proj.weight cuda:0
transformer.h.2.ln_1.weight cuda:0
transformer.h.2.attn.c_attn.weight cuda:0
transformer.h.2.attn.c_attn.bias cuda:0
transformer.h.2.attn.c_proj.weight cuda:0
transformer.h.2.ln_2.weight cuda:0
transformer.h.2.mlp.w1.weight cuda:0
transformer.h.2.mlp.w2.weight cuda:0
transformer.h.2.mlp.c_proj.weight cuda:0
transformer.h.3.ln_1.weight cuda:0
transformer.h.3.attn.c_attn.weight cuda:0
transformer.h.3.attn.c_attn.bias cuda:0
transformer.h.3.attn.c_proj.weight cuda:0
transformer.h.3.ln_2.weight cuda:0
transformer.h.3.mlp.w1.weight cuda:0
transformer.h.3.mlp.w2.weight cuda:0
transformer.h.3.mlp.c_proj.weight cuda:0
transformer.h.4.ln_1.weight cuda:0
transformer.h.4.attn.c_attn.weight cuda:0
transformer.h.4.attn.c_attn.bias cuda:0
transformer.h.4.attn.c_proj.weight cuda:0
transformer.h.4.ln_2.weight cuda:0
transformer.h.4.mlp.w1.weight cuda:0
transformer.h.4.mlp.w2.weight cuda:0
transformer.h.4.mlp.c_proj.weight cuda:0
transformer.h.5.ln_1.weight cuda:0
transformer.h.5.attn.c_attn.weight cuda:0
transformer.h.5.attn.c_attn.bias cuda:0
transformer.h.5.attn.c_proj.weight cuda:0
transformer.h.5.ln_2.weight cuda:0
transformer.h.5.mlp.w1.weight cuda:0
transformer.h.5.mlp.w2.weight cuda:0
transformer.h.5.mlp.c_proj.weight cuda:0
transformer.h.6.ln_1.weight cuda:0
transformer.h.6.attn.c_attn.weight cuda:0
transformer.h.6.attn.c_attn.bias cuda:0
transformer.h.6.attn.c_proj.weight cuda:0
transformer.h.6.ln_2.weight cuda:0
transformer.h.6.mlp.w1.weight cuda:0
transformer.h.6.mlp.w2.weight cuda:0
transformer.h.6.mlp.c_proj.weight cuda:0
transformer.h.7.ln_1.weight cuda:0
transformer.h.7.attn.c_attn.weight cuda:0
transformer.h.7.attn.c_attn.bias cuda:0
transformer.h.7.attn.c_proj.weight cuda:0
transformer.h.7.ln_2.weight cuda:0
transformer.h.7.mlp.w1.weight cuda:0
transformer.h.7.mlp.w2.weight cuda:0
transformer.h.7.mlp.c_proj.weight cuda:0
transformer.h.8.ln_1.weight cuda:0
transformer.h.8.attn.c_attn.weight cuda:0
transformer.h.8.attn.c_attn.bias cuda:0
transformer.h.8.attn.c_proj.weight cuda:0
transformer.h.8.ln_2.weight cuda:0
transformer.h.8.mlp.w1.weight cuda:0
transformer.h.8.mlp.w2.weight cuda:0
transformer.h.8.mlp.c_proj.weight cuda:0
transformer.h.9.ln_1.weight cuda:0
transformer.h.9.attn.c_attn.weight cuda:0
transformer.h.9.attn.c_attn.bias cuda:0
transformer.h.9.attn.c_proj.weight cuda:0
transformer.h.9.ln_2.weight cuda:0
transformer.h.9.mlp.w1.weight cuda:0
transformer.h.9.mlp.w2.weight cuda:0
transformer.h.9.mlp.c_proj.weight cuda:0
transformer.h.10.ln_1.weight cuda:0
transformer.h.10.attn.c_attn.weight cuda:0
transformer.h.10.attn.c_attn.bias cuda:0
transformer.h.10.attn.c_proj.weight cuda:0
transformer.h.10.ln_2.weight cuda:0
transformer.h.10.mlp.w1.weight cuda:0
transformer.h.10.mlp.w2.weight cuda:0
transformer.h.10.mlp.c_proj.weight cuda:0
transformer.h.11.ln_1.weight cuda:0
transformer.h.11.attn.c_attn.weight cuda:0
transformer.h.11.attn.c_attn.bias cuda:0
transformer.h.11.attn.c_proj.weight cuda:0
transformer.h.11.ln_2.weight cuda:0
transformer.h.11.mlp.w1.weight cuda:0
transformer.h.11.mlp.w2.weight cuda:0
transformer.h.11.mlp.c_proj.weight cuda:0
transformer.h.12.ln_1.weight cuda:0
transformer.h.12.attn.c_attn.weight cuda:0
transformer.h.12.attn.c_attn.bias cuda:0
transformer.h.12.attn.c_proj.weight cuda:0
transformer.h.12.ln_2.weight cuda:0
transformer.h.12.mlp.w1.weight cuda:0
transformer.h.12.mlp.w2.weight cuda:0
transformer.h.12.mlp.c_proj.weight cuda:0
transformer.h.13.ln_1.weight cuda:0
transformer.h.13.attn.c_attn.weight cuda:0
transformer.h.13.attn.c_attn.bias cuda:0
transformer.h.13.attn.c_proj.weight cuda:0
transformer.h.13.ln_2.weight cuda:0
transformer.h.13.mlp.w1.weight cuda:0
transformer.h.13.mlp.w2.weight cuda:0
transformer.h.13.mlp.c_proj.weight cuda:0
transformer.h.14.ln_1.weight cuda:0
transformer.h.14.attn.c_attn.weight cuda:0
transformer.h.14.attn.c_attn.bias cuda:0
transformer.h.14.attn.c_proj.weight cuda:0
transformer.h.14.ln_2.weight cuda:0
transformer.h.14.mlp.w1.weight cuda:0
transformer.h.14.mlp.w2.weight cuda:0
transformer.h.14.mlp.c_proj.weight cuda:0
transformer.h.15.ln_1.weight cuda:0
transformer.h.15.attn.c_attn.weight cuda:0
transformer.h.15.attn.c_attn.bias cuda:0
transformer.h.15.attn.c_proj.weight cuda:0
transformer.h.15.ln_2.weight cuda:0
transformer.h.15.mlp.w1.weight cuda:0
transformer.h.15.mlp.w2.weight cuda:0
transformer.h.15.mlp.c_proj.weight cuda:0
transformer.h.16.ln_1.weight cuda:0
transformer.h.16.attn.c_attn.weight cuda:0
transformer.h.16.attn.c_attn.bias cuda:0
transformer.h.16.attn.c_proj.weight cuda:0
transformer.h.16.ln_2.weight cuda:0
transformer.h.16.mlp.w1.weight cuda:0
transformer.h.16.mlp.w2.weight cuda:0
transformer.h.16.mlp.c_proj.weight cuda:0
transformer.h.17.ln_1.weight cuda:0
transformer.h.17.attn.c_attn.weight cuda:0
transformer.h.17.attn.c_attn.bias cuda:0
transformer.h.17.attn.c_proj.weight cuda:0
transformer.h.17.ln_2.weight cuda:0
transformer.h.17.mlp.w1.weight cuda:0
transformer.h.17.mlp.w2.weight cuda:0
transformer.h.17.mlp.c_proj.weight cuda:0
transformer.h.18.ln_1.weight cuda:0
transformer.h.18.attn.c_attn.weight cuda:0
transformer.h.18.attn.c_attn.bias cuda:0
transformer.h.18.attn.c_proj.weight cuda:0
transformer.h.18.ln_2.weight cuda:0
transformer.h.18.mlp.w1.weight cuda:0
transformer.h.18.mlp.w2.weight cuda:0
transformer.h.18.mlp.c_proj.weight cuda:0
transformer.h.19.ln_1.weight cuda:0
transformer.h.19.attn.c_attn.weight cuda:0
transformer.h.19.attn.c_attn.bias cuda:0
transformer.h.19.attn.c_proj.weight cuda:0
transformer.h.19.ln_2.weight cuda:0
transformer.h.19.mlp.w1.weight cuda:0
transformer.h.19.mlp.w2.weight cuda:0
transformer.h.19.mlp.c_proj.weight cuda:0
transformer.h.20.ln_1.weight cuda:0
transformer.h.20.attn.c_attn.weight cuda:0
transformer.h.20.attn.c_attn.bias cuda:0
transformer.h.20.attn.c_proj.weight cuda:0
transformer.h.20.ln_2.weight cuda:0
transformer.h.20.mlp.w1.weight cuda:0
transformer.h.20.mlp.w2.weight cuda:0
transformer.h.20.mlp.c_proj.weight cuda:0
transformer.h.21.ln_1.weight cuda:0
transformer.h.21.attn.c_attn.weight cuda:0
transformer.h.21.attn.c_attn.bias cuda:0
transformer.h.21.attn.c_proj.weight cuda:0
transformer.h.21.ln_2.weight cuda:0
transformer.h.21.mlp.w1.weight cuda:0
transformer.h.21.mlp.w2.weight cuda:0
transformer.h.21.mlp.c_proj.weight cuda:0
transformer.h.22.ln_1.weight cuda:0
transformer.h.22.attn.c_attn.weight cuda:0
transformer.h.22.attn.c_attn.bias cuda:0
transformer.h.22.attn.c_proj.weight cuda:0
transformer.h.22.ln_2.weight cuda:0
transformer.h.22.mlp.w1.weight cuda:0
transformer.h.22.mlp.w2.weight cuda:0
transformer.h.22.mlp.c_proj.weight cuda:0
transformer.h.23.ln_1.weight cuda:0
transformer.h.23.attn.c_attn.weight cuda:0
transformer.h.23.attn.c_attn.bias cuda:0
transformer.h.23.attn.c_proj.weight cuda:0
transformer.h.23.ln_2.weight cuda:0
transformer.h.23.mlp.w1.weight cuda:0
transformer.h.23.mlp.w2.weight cuda:0
transformer.h.23.mlp.c_proj.weight cuda:0
transformer.h.24.ln_1.weight cuda:0
transformer.h.24.attn.c_attn.weight cuda:0
transformer.h.24.attn.c_attn.bias cuda:0
transformer.h.24.attn.c_proj.weight cuda:0
transformer.h.24.ln_2.weight cuda:0
transformer.h.24.mlp.w1.weight cuda:0
transformer.h.24.mlp.w2.weight cuda:0
transformer.h.24.mlp.c_proj.weight cuda:0
transformer.h.25.ln_1.weight cuda:0
transformer.h.25.attn.c_attn.weight cuda:0
transformer.h.25.attn.c_attn.bias cuda:0
transformer.h.25.attn.c_proj.weight cuda:0
transformer.h.25.ln_2.weight cuda:0
transformer.h.25.mlp.w1.weight cuda:0
transformer.h.25.mlp.w2.weight cuda:0
transformer.h.25.mlp.c_proj.weight cuda:0
transformer.h.26.ln_1.weight cuda:0
transformer.h.26.attn.c_attn.weight cuda:0
transformer.h.26.attn.c_attn.bias cuda:0
transformer.h.26.attn.c_proj.weight cuda:0
transformer.h.26.ln_2.weight cuda:0
transformer.h.26.mlp.w1.weight cuda:0
transformer.h.26.mlp.w2.weight cuda:0
transformer.h.26.mlp.c_proj.weight cuda:0
transformer.h.27.ln_1.weight cuda:0
transformer.h.27.attn.c_attn.weight cuda:0
transformer.h.27.attn.c_attn.bias cuda:0
transformer.h.27.attn.c_proj.weight cuda:0
transformer.h.27.ln_2.weight cuda:0
transformer.h.27.mlp.w1.weight cuda:0
transformer.h.27.mlp.w2.weight cuda:0
transformer.h.27.mlp.c_proj.weight cuda:0
transformer.h.28.ln_1.weight cuda:0
transformer.h.28.attn.c_attn.weight cuda:0
transformer.h.28.attn.c_attn.bias cuda:0
transformer.h.28.attn.c_proj.weight cuda:0
transformer.h.28.ln_2.weight cuda:0
transformer.h.28.mlp.w1.weight cuda:0
transformer.h.28.mlp.w2.weight cuda:0
transformer.h.28.mlp.c_proj.weight cuda:0
transformer.h.29.ln_1.weight cuda:0
transformer.h.29.attn.c_attn.weight cuda:0
transformer.h.29.attn.c_attn.bias cuda:0
transformer.h.29.attn.c_proj.weight cuda:0
transformer.h.29.ln_2.weight cuda:0
transformer.h.29.mlp.w1.weight cuda:0
transformer.h.29.mlp.w2.weight cuda:0
transformer.h.29.mlp.c_proj.weight cuda:0
transformer.h.30.ln_1.weight cuda:0
transformer.h.30.attn.c_attn.weight cuda:0
transformer.h.30.attn.c_attn.bias cuda:0
transformer.h.30.attn.c_proj.weight cuda:0
transformer.h.30.ln_2.weight cuda:0
transformer.h.30.mlp.w1.weight cuda:0
transformer.h.30.mlp.w2.weight cuda:0
transformer.h.30.mlp.c_proj.weight cuda:0
transformer.h.31.ln_1.weight cuda:0
transformer.h.31.attn.c_attn.weight cuda:0
transformer.h.31.attn.c_attn.bias cuda:0
transformer.h.31.attn.c_proj.weight cuda:0
transformer.h.31.ln_2.weight cuda:0
transformer.h.31.mlp.w1.weight cuda:0
transformer.h.31.mlp.w2.weight cuda:0
transformer.h.31.mlp.c_proj.weight cuda:0
transformer.ln_f.weight cuda:0
lm_head.weight cuda:0
transformer.rotary_emb.inv_freq cuda:0
transformer.h.0.attn.masked_bias cuda:0
transformer.h.0.attn.logn_tensor cuda:0
transformer.h.1.attn.masked_bias cuda:0
transformer.h.1.attn.logn_tensor cuda:0
transformer.h.2.attn.masked_bias cuda:0
transformer.h.2.attn.logn_tensor cuda:0
transformer.h.3.attn.masked_bias cuda:0
transformer.h.3.attn.logn_tensor cuda:0
transformer.h.4.attn.masked_bias cuda:0
transformer.h.4.attn.logn_tensor cuda:0
transformer.h.5.attn.masked_bias cuda:0
transformer.h.5.attn.logn_tensor cuda:0
transformer.h.6.attn.masked_bias cuda:0
transformer.h.6.attn.logn_tensor cuda:0
transformer.h.7.attn.masked_bias cuda:0
transformer.h.7.attn.logn_tensor cuda:0
transformer.h.8.attn.masked_bias cuda:0
transformer.h.8.attn.logn_tensor cuda:0
transformer.h.9.attn.masked_bias cuda:0
transformer.h.9.attn.logn_tensor cuda:0
transformer.h.10.attn.masked_bias cuda:0
transformer.h.10.attn.logn_tensor cuda:0
transformer.h.11.attn.masked_bias cuda:0
transformer.h.11.attn.logn_tensor cuda:0
transformer.h.12.attn.masked_bias cuda:0
transformer.h.12.attn.logn_tensor cuda:0
transformer.h.13.attn.masked_bias cuda:0
transformer.h.13.attn.logn_tensor cuda:0
transformer.h.14.attn.masked_bias cuda:0
transformer.h.14.attn.logn_tensor cuda:0
transformer.h.15.attn.masked_bias cuda:0
transformer.h.15.attn.logn_tensor cuda:0
transformer.h.16.attn.masked_bias cuda:0
transformer.h.16.attn.logn_tensor cuda:0
transformer.h.17.attn.masked_bias cuda:0
transformer.h.17.attn.logn_tensor cuda:0
transformer.h.18.attn.masked_bias cuda:0
transformer.h.18.attn.logn_tensor cuda:0
transformer.h.19.attn.masked_bias cuda:0
transformer.h.19.attn.logn_tensor cuda:0
transformer.h.20.attn.masked_bias cuda:0
transformer.h.20.attn.logn_tensor cuda:0
transformer.h.21.attn.masked_bias cuda:0
transformer.h.21.attn.logn_tensor cuda:0
transformer.h.22.attn.masked_bias cuda:0
transformer.h.22.attn.logn_tensor cuda:0
transformer.h.23.attn.masked_bias cuda:0
transformer.h.23.attn.logn_tensor cuda:0
transformer.h.24.attn.masked_bias cuda:0
transformer.h.24.attn.logn_tensor cuda:0
transformer.h.25.attn.masked_bias cuda:0
transformer.h.25.attn.logn_tensor cuda:0
transformer.h.26.attn.masked_bias cuda:0
transformer.h.26.attn.logn_tensor cuda:0
transformer.h.27.attn.masked_bias cuda:0
transformer.h.27.attn.logn_tensor cuda:0
transformer.h.28.attn.masked_bias cuda:0
transformer.h.28.attn.logn_tensor cuda:0
transformer.h.29.attn.masked_bias cuda:0
transformer.h.29.attn.logn_tensor cuda:0
transformer.h.30.attn.masked_bias cuda:0
transformer.h.30.attn.logn_tensor cuda:0
transformer.h.31.attn.masked_bias cuda:0
transformer.h.31.attn.logn_tensor cuda:0
--------
finished warm-up
model_loc: cpu, exec_loc: cpu
transformer.wte.weight cpu
transformer.h.0.ln_1.weight cpu
transformer.h.0.attn.c_attn.weight cpu
transformer.h.0.attn.c_attn.bias cpu
transformer.h.0.attn.c_proj.weight cpu
transformer.h.0.ln_2.weight cpu
transformer.h.0.mlp.w1.weight cpu
transformer.h.0.mlp.w2.weight cpu
transformer.h.0.mlp.c_proj.weight cpu
transformer.h.1.ln_1.weight cpu
transformer.h.1.attn.c_attn.weight cpu
transformer.h.1.attn.c_attn.bias cpu
transformer.h.1.attn.c_proj.weight cpu
transformer.h.1.ln_2.weight cpu
transformer.h.1.mlp.w1.weight cpu
transformer.h.1.mlp.w2.weight cpu
transformer.h.1.mlp.c_proj.weight cpu
transformer.h.2.ln_1.weight cpu
transformer.h.2.attn.c_attn.weight cpu
transformer.h.2.attn.c_attn.bias cpu
transformer.h.2.attn.c_proj.weight cpu
transformer.h.2.ln_2.weight cpu
transformer.h.2.mlp.w1.weight cpu
transformer.h.2.mlp.w2.weight cpu
transformer.h.2.mlp.c_proj.weight cpu
transformer.h.3.ln_1.weight cpu
transformer.h.3.attn.c_attn.weight cpu
transformer.h.3.attn.c_attn.bias cpu
transformer.h.3.attn.c_proj.weight cpu
transformer.h.3.ln_2.weight cpu
transformer.h.3.mlp.w1.weight cpu
transformer.h.3.mlp.w2.weight cpu
transformer.h.3.mlp.c_proj.weight cpu
transformer.h.4.ln_1.weight cpu
transformer.h.4.attn.c_attn.weight cpu
transformer.h.4.attn.c_attn.bias cpu
transformer.h.4.attn.c_proj.weight cpu
transformer.h.4.ln_2.weight cpu
transformer.h.4.mlp.w1.weight cpu
transformer.h.4.mlp.w2.weight cpu
transformer.h.4.mlp.c_proj.weight cpu
transformer.h.5.ln_1.weight cpu
transformer.h.5.attn.c_attn.weight cpu
transformer.h.5.attn.c_attn.bias cpu
transformer.h.5.attn.c_proj.weight cpu
transformer.h.5.ln_2.weight cpu
transformer.h.5.mlp.w1.weight cpu
transformer.h.5.mlp.w2.weight cpu
transformer.h.5.mlp.c_proj.weight cpu
transformer.h.6.ln_1.weight cpu
transformer.h.6.attn.c_attn.weight cpu
transformer.h.6.attn.c_attn.bias cpu
transformer.h.6.attn.c_proj.weight cpu
transformer.h.6.ln_2.weight cpu
transformer.h.6.mlp.w1.weight cpu
transformer.h.6.mlp.w2.weight cpu
transformer.h.6.mlp.c_proj.weight cpu
transformer.h.7.ln_1.weight cpu
transformer.h.7.attn.c_attn.weight cpu
transformer.h.7.attn.c_attn.bias cpu
transformer.h.7.attn.c_proj.weight cpu
transformer.h.7.ln_2.weight cpu
transformer.h.7.mlp.w1.weight cpu
transformer.h.7.mlp.w2.weight cpu
transformer.h.7.mlp.c_proj.weight cpu
transformer.h.8.ln_1.weight cpu
transformer.h.8.attn.c_attn.weight cpu
transformer.h.8.attn.c_attn.bias cpu
transformer.h.8.attn.c_proj.weight cpu
transformer.h.8.ln_2.weight cpu
transformer.h.8.mlp.w1.weight cpu
transformer.h.8.mlp.w2.weight cpu
transformer.h.8.mlp.c_proj.weight cpu
transformer.h.9.ln_1.weight cpu
transformer.h.9.attn.c_attn.weight cpu
transformer.h.9.attn.c_attn.bias cpu
transformer.h.9.attn.c_proj.weight cpu
transformer.h.9.ln_2.weight cpu
transformer.h.9.mlp.w1.weight cpu
transformer.h.9.mlp.w2.weight cpu
transformer.h.9.mlp.c_proj.weight cpu
transformer.h.10.ln_1.weight cpu
transformer.h.10.attn.c_attn.weight cpu
transformer.h.10.attn.c_attn.bias cpu
transformer.h.10.attn.c_proj.weight cpu
transformer.h.10.ln_2.weight cpu
transformer.h.10.mlp.w1.weight cpu
transformer.h.10.mlp.w2.weight cpu
transformer.h.10.mlp.c_proj.weight cpu
transformer.h.11.ln_1.weight cpu
transformer.h.11.attn.c_attn.weight cpu
transformer.h.11.attn.c_attn.bias cpu
transformer.h.11.attn.c_proj.weight cpu
transformer.h.11.ln_2.weight cpu
transformer.h.11.mlp.w1.weight cpu
transformer.h.11.mlp.w2.weight cpu
transformer.h.11.mlp.c_proj.weight cpu
transformer.h.12.ln_1.weight cpu
transformer.h.12.attn.c_attn.weight cpu
transformer.h.12.attn.c_attn.bias cpu
transformer.h.12.attn.c_proj.weight cpu
transformer.h.12.ln_2.weight cpu
transformer.h.12.mlp.w1.weight cpu
transformer.h.12.mlp.w2.weight cpu
transformer.h.12.mlp.c_proj.weight cpu
transformer.h.13.ln_1.weight cpu
transformer.h.13.attn.c_attn.weight cpu
transformer.h.13.attn.c_attn.bias cpu
transformer.h.13.attn.c_proj.weight cpu
transformer.h.13.ln_2.weight cpu
transformer.h.13.mlp.w1.weight cpu
transformer.h.13.mlp.w2.weight cpu
transformer.h.13.mlp.c_proj.weight cpu
transformer.h.14.ln_1.weight cpu
transformer.h.14.attn.c_attn.weight cpu
transformer.h.14.attn.c_attn.bias cpu
transformer.h.14.attn.c_proj.weight cpu
transformer.h.14.ln_2.weight cpu
transformer.h.14.mlp.w1.weight cpu
transformer.h.14.mlp.w2.weight cpu
transformer.h.14.mlp.c_proj.weight cpu
transformer.h.15.ln_1.weight cpu
transformer.h.15.attn.c_attn.weight cpu
transformer.h.15.attn.c_attn.bias cpu
transformer.h.15.attn.c_proj.weight cpu
transformer.h.15.ln_2.weight cpu
transformer.h.15.mlp.w1.weight cpu
transformer.h.15.mlp.w2.weight cpu
transformer.h.15.mlp.c_proj.weight cpu
transformer.h.16.ln_1.weight cpu
transformer.h.16.attn.c_attn.weight cpu
transformer.h.16.attn.c_attn.bias cpu
transformer.h.16.attn.c_proj.weight cpu
transformer.h.16.ln_2.weight cpu
transformer.h.16.mlp.w1.weight cpu
transformer.h.16.mlp.w2.weight cpu
transformer.h.16.mlp.c_proj.weight cpu
transformer.h.17.ln_1.weight cpu
transformer.h.17.attn.c_attn.weight cpu
transformer.h.17.attn.c_attn.bias cpu
transformer.h.17.attn.c_proj.weight cpu
transformer.h.17.ln_2.weight cpu
transformer.h.17.mlp.w1.weight cpu
transformer.h.17.mlp.w2.weight cpu
transformer.h.17.mlp.c_proj.weight cpu
transformer.h.18.ln_1.weight cpu
transformer.h.18.attn.c_attn.weight cpu
transformer.h.18.attn.c_attn.bias cpu
transformer.h.18.attn.c_proj.weight cpu
transformer.h.18.ln_2.weight cpu
transformer.h.18.mlp.w1.weight cpu
transformer.h.18.mlp.w2.weight cpu
transformer.h.18.mlp.c_proj.weight cpu
transformer.h.19.ln_1.weight cpu
transformer.h.19.attn.c_attn.weight cpu
transformer.h.19.attn.c_attn.bias cpu
transformer.h.19.attn.c_proj.weight cpu
transformer.h.19.ln_2.weight cpu
transformer.h.19.mlp.w1.weight cpu
transformer.h.19.mlp.w2.weight cpu
transformer.h.19.mlp.c_proj.weight cpu
transformer.h.20.ln_1.weight cpu
transformer.h.20.attn.c_attn.weight cpu
transformer.h.20.attn.c_attn.bias cpu
transformer.h.20.attn.c_proj.weight cpu
transformer.h.20.ln_2.weight cpu
transformer.h.20.mlp.w1.weight cpu
transformer.h.20.mlp.w2.weight cpu
transformer.h.20.mlp.c_proj.weight cpu
transformer.h.21.ln_1.weight cpu
transformer.h.21.attn.c_attn.weight cpu
transformer.h.21.attn.c_attn.bias cpu
transformer.h.21.attn.c_proj.weight cpu
transformer.h.21.ln_2.weight cpu
transformer.h.21.mlp.w1.weight cpu
transformer.h.21.mlp.w2.weight cpu
transformer.h.21.mlp.c_proj.weight cpu
transformer.h.22.ln_1.weight cpu
transformer.h.22.attn.c_attn.weight cpu
transformer.h.22.attn.c_attn.bias cpu
transformer.h.22.attn.c_proj.weight cpu
transformer.h.22.ln_2.weight cpu
transformer.h.22.mlp.w1.weight cpu
transformer.h.22.mlp.w2.weight cpu
transformer.h.22.mlp.c_proj.weight cpu
transformer.h.23.ln_1.weight cpu
transformer.h.23.attn.c_attn.weight cpu
transformer.h.23.attn.c_attn.bias cpu
transformer.h.23.attn.c_proj.weight cpu
transformer.h.23.ln_2.weight cpu
transformer.h.23.mlp.w1.weight cpu
transformer.h.23.mlp.w2.weight cpu
transformer.h.23.mlp.c_proj.weight cpu
transformer.h.24.ln_1.weight cpu
transformer.h.24.attn.c_attn.weight cpu
transformer.h.24.attn.c_attn.bias cpu
transformer.h.24.attn.c_proj.weight cpu
transformer.h.24.ln_2.weight cpu
transformer.h.24.mlp.w1.weight cpu
transformer.h.24.mlp.w2.weight cpu
transformer.h.24.mlp.c_proj.weight cpu
transformer.h.25.ln_1.weight cpu
transformer.h.25.attn.c_attn.weight cpu
transformer.h.25.attn.c_attn.bias cpu
transformer.h.25.attn.c_proj.weight cpu
transformer.h.25.ln_2.weight cpu
transformer.h.25.mlp.w1.weight cpu
transformer.h.25.mlp.w2.weight cpu
transformer.h.25.mlp.c_proj.weight cpu
transformer.h.26.ln_1.weight cpu
transformer.h.26.attn.c_attn.weight cpu
transformer.h.26.attn.c_attn.bias cpu
transformer.h.26.attn.c_proj.weight cpu
transformer.h.26.ln_2.weight cpu
transformer.h.26.mlp.w1.weight cpu
transformer.h.26.mlp.w2.weight cpu
transformer.h.26.mlp.c_proj.weight cpu
transformer.h.27.ln_1.weight cpu
transformer.h.27.attn.c_attn.weight cpu
transformer.h.27.attn.c_attn.bias cpu
transformer.h.27.attn.c_proj.weight cpu
transformer.h.27.ln_2.weight cpu
transformer.h.27.mlp.w1.weight cpu
transformer.h.27.mlp.w2.weight cpu
transformer.h.27.mlp.c_proj.weight cpu
transformer.h.28.ln_1.weight cpu
transformer.h.28.attn.c_attn.weight cpu
transformer.h.28.attn.c_attn.bias cpu
transformer.h.28.attn.c_proj.weight cpu
transformer.h.28.ln_2.weight cpu
transformer.h.28.mlp.w1.weight cpu
transformer.h.28.mlp.w2.weight cpu
transformer.h.28.mlp.c_proj.weight cpu
transformer.h.29.ln_1.weight cpu
transformer.h.29.attn.c_attn.weight cpu
transformer.h.29.attn.c_attn.bias cpu
transformer.h.29.attn.c_proj.weight cpu
transformer.h.29.ln_2.weight cpu
transformer.h.29.mlp.w1.weight cpu
transformer.h.29.mlp.w2.weight cpu
transformer.h.29.mlp.c_proj.weight cpu
transformer.h.30.ln_1.weight cpu
transformer.h.30.attn.c_attn.weight cpu
transformer.h.30.attn.c_attn.bias cpu
transformer.h.30.attn.c_proj.weight cpu
transformer.h.30.ln_2.weight cpu
transformer.h.30.mlp.w1.weight cpu
transformer.h.30.mlp.w2.weight cpu
transformer.h.30.mlp.c_proj.weight cpu
transformer.h.31.ln_1.weight cpu
transformer.h.31.attn.c_attn.weight cpu
transformer.h.31.attn.c_attn.bias cpu
transformer.h.31.attn.c_proj.weight cpu
transformer.h.31.ln_2.weight cpu
transformer.h.31.mlp.w1.weight cpu
transformer.h.31.mlp.w2.weight cpu
transformer.h.31.mlp.c_proj.weight cpu
transformer.ln_f.weight cpu
lm_head.weight cpu
transformer.rotary_emb.inv_freq cpu
transformer.h.0.attn.masked_bias cpu
transformer.h.0.attn.logn_tensor cpu
transformer.h.1.attn.masked_bias cpu
transformer.h.1.attn.logn_tensor cpu
transformer.h.2.attn.masked_bias cpu
transformer.h.2.attn.logn_tensor cpu
transformer.h.3.attn.masked_bias cpu
transformer.h.3.attn.logn_tensor cpu
transformer.h.4.attn.masked_bias cpu
transformer.h.4.attn.logn_tensor cpu
transformer.h.5.attn.masked_bias cpu
transformer.h.5.attn.logn_tensor cpu
transformer.h.6.attn.masked_bias cpu
transformer.h.6.attn.logn_tensor cpu
transformer.h.7.attn.masked_bias cpu
transformer.h.7.attn.logn_tensor cpu
transformer.h.8.attn.masked_bias cpu
transformer.h.8.attn.logn_tensor cpu
transformer.h.9.attn.masked_bias cpu
transformer.h.9.attn.logn_tensor cpu
transformer.h.10.attn.masked_bias cpu
transformer.h.10.attn.logn_tensor cpu
transformer.h.11.attn.masked_bias cpu
transformer.h.11.attn.logn_tensor cpu
transformer.h.12.attn.masked_bias cpu
transformer.h.12.attn.logn_tensor cpu
transformer.h.13.attn.masked_bias cpu
transformer.h.13.attn.logn_tensor cpu
transformer.h.14.attn.masked_bias cpu
transformer.h.14.attn.logn_tensor cpu
transformer.h.15.attn.masked_bias cpu
transformer.h.15.attn.logn_tensor cpu
transformer.h.16.attn.masked_bias cpu
transformer.h.16.attn.logn_tensor cpu
transformer.h.17.attn.masked_bias cpu
transformer.h.17.attn.logn_tensor cpu
transformer.h.18.attn.masked_bias cpu
transformer.h.18.attn.logn_tensor cpu
transformer.h.19.attn.masked_bias cpu
transformer.h.19.attn.logn_tensor cpu
transformer.h.20.attn.masked_bias cpu
transformer.h.20.attn.logn_tensor cpu
transformer.h.21.attn.masked_bias cpu
transformer.h.21.attn.logn_tensor cpu
transformer.h.22.attn.masked_bias cpu
transformer.h.22.attn.logn_tensor cpu
transformer.h.23.attn.masked_bias cpu
transformer.h.23.attn.logn_tensor cpu
transformer.h.24.attn.masked_bias cpu
transformer.h.24.attn.logn_tensor cpu
transformer.h.25.attn.masked_bias cpu
transformer.h.25.attn.logn_tensor cpu
transformer.h.26.attn.masked_bias cpu
transformer.h.26.attn.logn_tensor cpu
transformer.h.27.attn.masked_bias cpu
transformer.h.27.attn.logn_tensor cpu
transformer.h.28.attn.masked_bias cpu
transformer.h.28.attn.logn_tensor cpu
transformer.h.29.attn.masked_bias cpu
transformer.h.29.attn.logn_tensor cpu
transformer.h.30.attn.masked_bias cpu
transformer.h.30.attn.logn_tensor cpu
transformer.h.31.attn.masked_bias cpu
transformer.h.31.attn.logn_tensor cpu
--------
    res = run_llm(model, tokenizer, model_loc=mode[0], exec_loc=mode[1])
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/users/fbrunne/projects/benchmarks/run-patch.py", line 83, in run_llm
    output = model.generate(**input_batch,  max_new_tokens=1, min_new_tokens=1, do_sample=False)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/users/fbrunne/.cache/huggingface/modules/transformers_modules/Qwen/Qwen-7B/ef3c5c9c57b252f3149c1408daf4d649ec8b6c85/modeling_qwen.py", line 1259, in generate
    return super().generate(
           ^^^^^^^^^^^^^^^^^
  File "/users/fbrunne/projects/deps/patch-venv/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/users/fbrunne/projects/deps/patch-venv/lib/python3.11/site-packages/transformers/generation/utils.py", line 1576, in generate
    result = self._greedy_search(
             ^^^^^^^^^^^^^^^^^^^^
  File "/users/fbrunne/projects/deps/patch-venv/lib/python3.11/site-packages/transformers/generation/utils.py", line 2494, in _greedy_search
    outputs = self(
              ^^^^^
  File "/users/fbrunne/projects/deps/patch-venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/users/fbrunne/projects/deps/patch-venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/users/fbrunne/.cache/huggingface/modules/transformers_modules/Qwen/Qwen-7B/ef3c5c9c57b252f3149c1408daf4d649ec8b6c85/modeling_qwen.py", line 1043, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/users/fbrunne/projects/deps/patch-venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/users/fbrunne/projects/deps/patch-venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/users/fbrunne/.cache/huggingface/modules/transformers_modules/Qwen/Qwen-7B/ef3c5c9c57b252f3149c1408daf4d649ec8b6c85/modeling_qwen.py", line 891, in forward
    outputs = block(
              ^^^^^^
  File "/users/fbrunne/projects/deps/patch-venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/users/fbrunne/projects/deps/patch-venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/users/fbrunne/.cache/huggingface/modules/transformers_modules/Qwen/Qwen-7B/ef3c5c9c57b252f3149c1408daf4d649ec8b6c85/modeling_qwen.py", line 610, in forward
    attn_outputs = self.attn(
                   ^^^^^^^^^^
  File "/users/fbrunne/projects/deps/patch-venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/users/fbrunne/projects/deps/patch-venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/users/fbrunne/.cache/huggingface/modules/transformers_modules/Qwen/Qwen-7B/ef3c5c9c57b252f3149c1408daf4d649ec8b6c85/modeling_qwen.py", line 432, in forward
    query = apply_rotary_pos_emb(query, q_pos_emb)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/users/fbrunne/.cache/huggingface/modules/transformers_modules/Qwen/Qwen-7B/ef3c5c9c57b252f3149c1408daf4d649ec8b6c85/modeling_qwen.py", line 1345, in apply_rotary_pos_emb
    t_rot = (t_rot * cos) + (_rotate_half(t_rot) * sin)
             ~~~~~~^~~~~
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!
srun: error: nid006788: task 0: Exited with exit code 1
srun: Terminating StepId=1070130.0
