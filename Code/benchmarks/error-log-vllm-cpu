fbrunne@nid007285:/iopsstor/scratch/cscs/fbrunne/benchmarks$ . benchmark-vllm-pipeline-cpu.sh "meta-llama/Llama-3.1-8B"

INFO 12-22 16:12:27 [__init__.py:216] Automatically detected platform cpu.

------ Running cpu_benchmark_changing_nr_threads ------

Nr threads: 1
INFO 12-22 16:12:29 [utils.py:233] non-default args: {'max_model_len': 2048, 'max_num_batched_tokens': 2048, 'disable_log_stats': True, 'model': 'meta-llama/Llama-3.1-8B'}
INFO 12-22 16:12:30 [model.py:547] Resolved architecture: LlamaForCausalLM
`torch_dtype` is deprecated! Use `dtype` instead!
INFO 12-22 16:12:30 [model.py:1510] Using max model len 2048
INFO 12-22 16:12:30 [arg_utils.py:1166] Chunked prefill is not supported for ARM and POWER and S390X CPUs; disabling it for V1 backend.
INFO 12-22 16:12:33 [__init__.py:216] Automatically detected platform cpu.
(EngineCore_DP0 pid=166001) INFO 12-22 16:12:35 [core.py:644] Waiting for init message from front-end.
(EngineCore_DP0 pid=166001) INFO 12-22 16:12:35 [core.py:77] Initializing a V1 LLM engine (v0.11.0) with config: model='meta-llama/Llama-3.1-8B', speculative_config=None, tokenizer='meta-llama/Llama-3.1-8B', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, tokenizer_revision=None, trust_remote_code=False, dtype=torch.bfloat16, max_seq_len=2048, download_dir=None, load_format=auto, tensor_parallel_size=1, pipeline_parallel_size=1, data_parallel_size=1, disable_custom_all_reduce=True, quantization=None, enforce_eager=False, kv_cache_dtype=auto, device_config=cpu, structured_outputs_config=StructuredOutputsConfig(backend='auto', disable_fallback=False, disable_any_whitespace=False, disable_additional_properties=False, reasoning_parser=''), observability_config=ObservabilityConfig(show_hidden_metrics_for_version=None, otlp_traces_endpoint=None, collect_detailed_traces=None), seed=0, served_model_name=meta-llama/Llama-3.1-8B, enable_prefix_caching=True, chunked_prefill_enabled=False, pooler_config=None, compilation_config={"level":2,"debug_dump_path":"","cache_dir":"","backend":"inductor","custom_ops":["none"],"splitting_ops":null,"use_inductor":true,"compile_sizes":null,"inductor_compile_config":{"enable_auto_functionalized_v2":false,"dce":true,"size_asserts":false,"nan_asserts":false,"epilogue_fusion":true},"inductor_passes":{},"cudagraph_mode":0,"use_cudagraph":true,"cudagraph_num_of_warmups":0,"cudagraph_capture_sizes":[],"cudagraph_copy_inputs":false,"full_cuda_graph":false,"use_inductor_graph_partition":false,"pass_config":{},"max_capture_size":null,"local_cache_dir":null}
(EngineCore_DP0 pid=166001) INFO 12-22 16:12:35 [importing.py:63] Triton not installed or not compatible; certain GPU-related functions will not be available.
(EngineCore_DP0 pid=166001) WARNING 12-22 16:12:36 [cpu.py:316] Pin memory is not supported on CPU.
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
(EngineCore_DP0 pid=166001) INFO 12-22 16:12:36 [parallel_state.py:1208] rank 0 in world size 1 is assigned as DP rank 0, PP rank 0, TP rank 0, EP rank 0
(EngineCore_DP0 pid=166001) INFO 12-22 16:12:36 [cpu_model_runner.py:106] Starting to load model meta-llama/Llama-3.1-8B...
(EngineCore_DP0 pid=166001) INFO 12-22 16:12:36 [cpu.py:104] Using Torch SDPA backend.
(EngineCore_DP0 pid=166001) INFO 12-22 16:12:37 [weight_utils.py:392] Using model weights format ['*.safetensors']
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:00<00:00,  9.64it/s]
Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:00<00:00,  2.12it/s]
Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:01<00:00,  1.70it/s]
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.81it/s]
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.94it/s]
(EngineCore_DP0 pid=166001) 
(EngineCore_DP0 pid=166001) INFO 12-22 16:12:39 [default_loader.py:267] Loading weights took 2.07 seconds
(EngineCore_DP0 pid=166001) INFO 12-22 16:12:39 [kv_cache_utils.py:1087] GPU KV cache size: 163,840 tokens
(EngineCore_DP0 pid=166001) INFO 12-22 16:12:39 [kv_cache_utils.py:1091] Maximum concurrency for 2,048 tokens per request: 80.00x
(EngineCore_DP0 pid=166001) INFO 12-22 16:12:40 [cpu_model_runner.py:117] Warming up model for the compilation...
(EngineCore_DP0 pid=166001) WARNING 12-22 16:12:40 [cudagraph_dispatcher.py:106] cudagraph dispatching keys are not initialized. No cudagraph will be used.
(EngineCore_DP0 pid=166001) INFO 12-22 16:12:45 [cpu_model_runner.py:121] Warming up done.
(EngineCore_DP0 pid=166001) INFO 12-22 16:12:45 [core.py:210] init engine (profile, create kv cache, warmup model) took 6.21 seconds
INFO 12-22 16:12:46 [llm.py:306] Supported_tasks: ['generate']
Adding requests: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 1221.40it/s]
Processed prompts:   0%|                                                                           | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]